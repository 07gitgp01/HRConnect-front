<div class="volontaires-container">
  <div class="container-header">
<!--     <h1>Mes Volontaires</h1>
 -->    <div class="header-stats">
      <div class="stat-badge">
        <span class="stat-number">{{ getTotalVolontaires() }}</span>
        <span class="stat-label">Volontaires total</span>
      </div>
      <div class="stat-badge success">
        <span class="stat-number">{{ getVolontairesEnMission() }}</span>
        <span class="stat-label">En mission</span>
      </div>
      <div class="stat-badge info">
        <span class="stat-number">{{ getMissionsEnCoursCount() }}</span>
        <span class="stat-label">Missions en cours</span>
      </div>
    </div>
  </div>

  <!-- Navigation par onglets -->
  <nav class="section-tabs">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" href="#actifs" data-bs-toggle="tab">
          Volontaires Actifs ({{ volontairesActifs.length }})
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#missions" data-bs-toggle="tab">
          Missions en Cours ({{ missionsEnCours.length }})
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#inactifs" data-bs-toggle="tab">
          Anciens Volontaires ({{ volontairesInactifs.length }})
        </a>
      </li>
    </ul>
  </nav>

  <!-- Contenu des onglets -->
  <div class="tab-content mt-4">
    <!-- Onglet Volontaires Actifs -->
    <div class="tab-pane fade show active" id="actifs">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Nom</th>
              <th>Email</th>
              <th>Téléphone</th>
              <th>Mission actuelle</th>
              <th>Date début</th>
              <th>Date fin</th>
              <th>Durée restante</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let volontaire of volontairesActifs">
              <td>
                <div class="volontaire-info">
                  <div class="volontaire-nom">{{ volontaire.nom }} {{ volontaire.prenom }}</div>
                  <div class="volontaire-specialite">{{ volontaire.specialite }}</div>
                </div>
              </td>
              <td>{{ volontaire.email }}</td>
              <td>{{ volontaire.telephone }}</td>
              <td>
                <a [routerLink]="['/features/partenaires/projets', volontaire.mission.projetId]">
                  {{ volontaire.mission.titre }}
                </a>
              </td>
              <td>{{ volontaire.mission.dateDebut | date:'dd/MM/yyyy' }}</td>
              <td>{{ volontaire.mission.dateFin | date:'dd/MM/yyyy' }}</td>
              <td>
                <span class="badge" 
                      [ngClass]="{
                        'bg-success': !volontaire.mission.dateFin || isDateFuture(volontaire.mission.dateFin),
                        'bg-warning': volontaire.mission.dateFin && isDateNearFuture(volontaire.mission.dateFin),
                        'bg-danger': volontaire.mission.dateFin && isDatePastOrToday(volontaire.mission.dateFin)
                      }">
                  {{ calculerDureeRestante(volontaire.mission.dateFin) }}
                </span>
              </td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" title="Voir fiche">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-info" title="Contacter">
                    <i class="fas fa-envelope"></i>
                  </button>
                  <button class="btn btn-outline-warning" title="Évaluer">
                    <i class="fas fa-star"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Onglet Missions en Cours -->
    <div class="tab-pane fade" id="missions">
      <div class="missions-grid">
        <div *ngFor="let mission of missionsEnCours" class="mission-card">
          <div class="mission-header">
            <h4>{{ mission.projet?.title || 'Mission' }}</h4>
            <span class="mission-status badge bg-success">En cours</span>
          </div>
          <div class="mission-body">
            <div class="mission-info">
              <div class="info-item">
                <i class="fas fa-calendar"></i>
                <span>Du {{ mission.dateDebut | date:'dd/MM/yyyy' }} au {{ mission.dateFin | date:'dd/MM/yyyy' }}</span>
              </div>
              <div class="info-item">
                <i class="fas fa-clock"></i>
                <span>Durée restante: {{ getDureeRestante(mission.dateFin) }}</span>
              </div>
              <div class="info-item">
                <i class="fas fa-users"></i>
                <span>{{ mission.volontaires?.length || 0 }} volontaire(s)</span>
              </div>
            </div>
            
            <div class="volontaires-list" *ngIf="mission.volontaires?.length">
              <h6>Volontaires affectés:</h6>
              <div class="volontaire-chips">
                <span *ngFor="let affectation of mission.volontaires" class="badge bg-light text-dark me-2 mb-2">
                  {{ affectation.volontaireInfo?.nom }} {{ affectation.volontaireInfo?.prenom }}
                  <button class="btn-close btn-close-sm ms-1" title="Retirer"></button>
                </span>
              </div>
            </div>
          </div>
          <div class="mission-footer">
            <a [routerLink]="['/features/partenaires/projets', mission.projet?.id]" class="btn btn-sm btn-primary" *ngIf="mission.projet?.id">
              Voir la mission
            </a>
            <button class="btn btn-sm btn-outline-secondary">
              <i class="fas fa-file-alt me-1"></i> Rapports
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Onglet Anciens Volontaires -->
    <div class="tab-pane fade" id="inactifs">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Nom</th>
              <th>Email</th>
              <th>Dernière mission</th>
              <th>Date de fin</th>
              <th>Évaluation</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let volontaire of volontairesInactifs">
              <td>{{ volontaire.nom }} {{ volontaire.prenom }}</td>
              <td>{{ volontaire.email }}</td>
              <td>
                <span *ngIf="volontaire.ancienneMission">
                  {{ volontaire.ancienneMission.titre }}
                </span>
                <span *ngIf="!volontaire.ancienneMission" class="text-muted">Non spécifiée</span>
              </td>
              <td>
                <span *ngIf="volontaire.ancienneMission?.dateFin">
                  {{ volontaire.ancienneMission.dateFin | date:'dd/MM/yyyy' }}
                </span>
              </td>
              <td>
                <div class="rating" *ngIf="volontaire.evaluation; else noEvaluation">
                  <i *ngFor="let star of [1,2,3,4,5]" 
                     class="fas fa-star" 
                     [ngClass]="{'text-warning': star <= volontaire.evaluation.note}"></i>
                </div>
                <ng-template #noEvaluation>
                  <span class="badge bg-secondary">Non évalué</span>
                </ng-template>
              </td>
              <td>
                <button class="btn btn-sm btn-outline-primary">
                  <i class="fas fa-redo me-1"></i> Réaffecter
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>